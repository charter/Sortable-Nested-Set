h3. Sortable Nested Set for Rails 3.1.rc6

Dreaming about Drag and Drop for Nested Sets? It's should be with JQuery?
Here's the solution!

*There is _almost_ production solution for you web site!* Just try!

Server side:

# Rails 3.1 rc6
# Nested Set Gem

Client side:

# JQuery 1.6 +
# jQuery UI Nested Sortable (Manuele J Sarfatti)
# piece of Ajax code

h3. Installing

# cd ~
# git clone git@github.com:the-teacher/Sortable-Nested-Set.git
# cd Sortable-Nested-Set/
# sudo bundle install

*config/database.yml*

<pre>
  development:
    adapter: mysql2
    database: sortable_nested_set_dev
    host: localhost
    username: root
    password: qwerty
    encoding: utf8
    timeout: 5000

  production:
    adapter: mysql2
    database: sortable_nested_set_pro
    host: localhost
    username: root
    password: qwerty
    encoding: utf8
    timeout: 5000
</pre>


# rake app:create
# rails s

*Browser: localhost:3000*

External links

# jQuery UI Nested Sortable "http://mjsarfatti.com/sandbox/nestedSortable/":http://mjsarfatti.com/sandbox/nestedSortable/
# Rails 3 Nested Set Gem "https://github.com/skyeagle/nested_set":https://github.com/skyeagle/nested_set

h3. Acknowledgments

"Iconza":http://iconza.com/ for free icons for this application

h2. Understanding

We have an objects. This application uses the pages (Page Model).
Page Model include nested_set functionality (gem nested_set).

*models/page.rb*

<pre>
class Page < ActiveRecord::Base
  acts_as_nested_set

  scope :nested_set,          order('lft ASC')
  scope :reversed_nested_set, order('lft DESC')

end
</pre>

We get a lot of pages

*controllers/pages_controller.rb*

<pre>
class PagesController < ApplicationController
  def index
    @pages = Page.nested_set.all
  end
end
</pre>

We rendering pages with *ans_tree* helper

*views/pages/index.haml*

<pre>
%ol.sortable.ui-sortable.nested_set#nested_set
  = raw ans_tree(@pages, :path=>'pages/nested_set', :admin=>true, :class_name=>'Page', :id_field=>:id)
</pre>






